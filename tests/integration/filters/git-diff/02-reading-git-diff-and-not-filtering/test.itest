RUN: mkdir -p sandbox
RUN: cp sample.cpp.original sandbox/sample.cpp
RUN: cd sandbox
RUN: git init . -b main
RUN: git add sample.cpp
RUN: git -c user.name='Mull' -c user.email=alex@lowlevelbits.org commit -m "Impersonation is evil."
RUN: cp ../sample.cpp.modified sample.cpp
RUN: cd ..
RUN: %clang_cxx %sysroot -S -emit-llvm -g -O0 sandbox/sample.cpp -o sample.cpp.ll
RUN: %clang_cxx %sysroot -O0 %pass_mull_ir_frontend -g sandbox/sample.cpp -o sample.cpp-ir.exe | %filecheck %s --dump-input=fail --strict-whitespace --match-full-lines --check-prefix=CHECK_MUTATE

RUN: (unset TERM; %mull_runner -ide-reporter-show-killed sample.cpp-ir.exe 2>&1; test $? = 0) | %filecheck %s --dump-input=fail --strict-whitespace --match-full-lines

CHECK_MUTATE:[debug] GitDiffFilter: skipping instruction: {{.*}}/sample.cpp:4:7
CHECK_MUTATE:[debug] GitDiffFilter: skipping instruction: {{.*}}/sample.cpp:4:11
CHECK_MUTATE:[debug] GitDiffFilter: skipping instruction: {{.*}}/sample.cpp:7:7
CHECK_MUTATE:[debug] GitDiffFilter: skipping instruction: {{.*}}/sample.cpp:7:11

CHECK:[info] No mutants found. Mutation score: infinitely high
